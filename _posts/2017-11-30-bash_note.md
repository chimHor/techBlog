---
layout: post
title: bash常用命令笔记
tags: bash linux
---

#### 字符处理

| 表达式 | 含义 |
|--------|--------|
| ${#string} | $string的长度 |
| ${string:position} | 在$string中, 从位置$position开始提取子串 |
| ${string:position:length} | 在$string中, 从位置$position开始提取长度为$length的子串 |
|${string#substring} | 从变量$string的开头, 删除最短匹配$substring的子串 |
|${string##substring} | 从变量$string的开头, 删除最长匹配$substring的子串 |
|${string%substring} | 从变量$string的结尾, 删除最短匹配$substring的子串 |
|${string%%substring} | 从变量$string的结尾, 删除最长匹配$substring的子串 |
|${string/substring/replacement} | 使用$replacement, 来代替第一个匹配的$substring |
|${string//substring/replacement} | 使用$replacement, 代替所有匹配的$substring |
|${string/#substring/replacement} | 如果$string的前缀匹配$substring, 那么就用$replacement来代替匹配到的$substring |
|${string/%substring/replacement} | 如果$string的后缀匹配$substring, 那么就用$replacement来代替匹配到的$substring |

#### windows转unix格式

```
busybox dos2unix [file]
```

#### 移除行尾空格

```
sed -i 's/[ \t]*$//g' [file]
```

#### 替换tab为4个空格

```
sed -i 's/\t/    /g' [file]
```

#### 判断文件(夹)存在

```
    if [ ! -e .repo/manifests ]; then
        echo " is it in sdk ?"
        echo "abort"
        exit 0
    fi
```

判断函数参数数量

```
    if [ $# -eq 1 ]; then
        echo $1
    else
        echo "wrong para num"
        return
    fi
```

#### 赋值

```
filename=$(basename "/usr/bin/python")
```

#### 遍历文本文件每行内容

```
    for project in `cat ~/project_list.txt`
    do
       echo  $project
    done
```

#### 获取执行的脚本所在的路径

```
WORKDIR=$(pwd)
TMPDIR=$(dirname ${BASH_SOURCE[0]})
cd $TMPDIR
MYDIR=$(pwd)
cd $WORKDIR
```

#### bash调试方法(打印每一句执行),-x参数

```
#!/usr/bin/bash -x
```

或者

```
#打开调试打印
set -x
#关闭调试打印
set +x
```

#### bash错误立刻退出，-e参数

```
#!/usr/bin/bash -e
```

或者

```
#打开出错立刻退出
set -e
#关闭出错立刻退出
set +e
```

#### assert函数

```
function assert() {
    if [ "$?" -ne 0 ]; then
        if [ $# -eq 1 ]; then
            echo $1
        else
            #echo "error "
        fi
        # erro handle
        exit
    fi
}
```
